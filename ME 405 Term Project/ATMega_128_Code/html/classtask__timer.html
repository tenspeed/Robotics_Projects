<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Polar Plotter Project: task_timer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Polar Plotter Project
   &#160;<span id="projectnumber">5.0</span>
   </div>
   <div id="projectbrief">A 2D Polar Plotter for Drawing Straight Lines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classtask__timer.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classtask__timer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">task_timer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="stl__timer_8h_source.html">stl_timer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af8d96cae8e4b94970a96df6fef2a75b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__timer.html#af8d96cae8e4b94970a96df6fef2a75b8">task_timer</a> (void)</td></tr>
<tr class="separator:af8d96cae8e4b94970a96df6fef2a75b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56c09d1da6107f284d12e079f0de62ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__timer.html#a56c09d1da6107f284d12e079f0de62ed">save_time_stamp</a> (<a class="el" href="classtime__stamp.html">time_stamp</a> &amp;)</td></tr>
<tr class="memdesc:a56c09d1da6107f284d12e079f0de62ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor creates an empty timer.  <a href="#a56c09d1da6107f284d12e079f0de62ed">More...</a><br/></td></tr>
<tr class="separator:a56c09d1da6107f284d12e079f0de62ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2723e16b4d9e7c4f997547a9be1820ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtime__stamp.html">time_stamp</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__timer.html#a2723e16b4d9e7c4f997547a9be1820ed">get_time_now</a> (void)</td></tr>
<tr class="memdesc:a2723e16b4d9e7c4f997547a9be1820ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save current time in a timestamp.  <a href="#a2723e16b4d9e7c4f997547a9be1820ed">More...</a><br/></td></tr>
<tr class="separator:a2723e16b4d9e7c4f997547a9be1820ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae793fba368c36c813ae581c358c33c48"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__timer.html#ae793fba368c36c813ae581c358c33c48">set_time</a> (<a class="el" href="classtime__stamp.html">time_stamp</a> &amp;)</td></tr>
<tr class="memdesc:ae793fba368c36c813ae581c358c33c48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current time.  <a href="#ae793fba368c36c813ae581c358c33c48">More...</a><br/></td></tr>
<tr class="separator:ae793fba368c36c813ae581c358c33c48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a8c7dab1af76b4583fa9c6a744c2dbff0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8c7dab1af76b4583fa9c6a744c2dbff0"></a>
<a class="el" href="classtime__stamp.html">time_stamp</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask__timer.html#a8c7dab1af76b4583fa9c6a744c2dbff0">now_time</a></td></tr>
<tr class="memdesc:a8c7dab1af76b4583fa9c6a744c2dbff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This time stamp object holds a most recently measured time. <br/></td></tr>
<tr class="separator:a8c7dab1af76b4583fa9c6a744c2dbff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements a timer to synchronize the operation of tasks on an AVR. The timer is implemented as a combination of a 16-bit hardware timer (Timer 1 is the usual choice) and a 16-bit overflow counter. The two timers' data is combined to produce a 32-bit time count which is used to decide when tasks run. WARNING: This timer does not keep track of the time of day, and it overflows after a little more than an hour of use. Another version of the stl_timer can be used when longer time periods need to be kept track of, to lower precision. </p>

<p>Definition at line <a class="el" href="stl__timer_8h_source.html#l00155">155</a> of file <a class="el" href="stl__timer_8h_source.html">stl_timer.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af8d96cae8e4b94970a96df6fef2a75b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">task_timer::task_timer </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This constructor creates a daytime task timer object. It sets up the hardware timer to count at ~1 MHz and interrupt on overflow. Note that this method does not enable interrupts globally, so the user must call sei() at some point to enable the timer interrupts to run and time to actually be measured. </p>

<p>Definition at line <a class="el" href="stl__timer_8cpp_source.html#l00328">328</a> of file <a class="el" href="stl__timer_8cpp_source.html">stl_timer.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a2723e16b4d9e7c4f997547a9be1820ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtime__stamp.html">time_stamp</a> &amp; task_timer::get_time_now </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save current time in a timestamp. </p>
<p>This method saves the current time in the internal time stamp belonging to this object, then returns a reference to the time stamp so that the caller can use it as a measurement of what the time is now. </p>

<p>Definition at line <a class="el" href="stl__timer_8cpp_source.html#l00375">375</a> of file <a class="el" href="stl__timer_8cpp_source.html">stl_timer.cpp</a>.</p>

<p>References <a class="el" href="stl__timer_8h_source.html#l00082">time_stamp::data</a>, <a class="el" href="stl__timer_8h_source.html#l00060">time_data_32::half</a>, <a class="el" href="stl__timer_8h_source.html#l00159">now_time</a>, <a class="el" href="stl__timer_8h_source.html#l00044">TMR_TCNT_REG</a>, and <a class="el" href="stl__timer_8cpp_source.html#l00044">ust_overflows</a>.</p>

<p>Referenced by <a class="el" href="stl__timer_8cpp_source.html#l00444">operator&lt;&lt;()</a>, and <a class="el" href="stl__task_8cpp_source.html#l00115">stl_task::schedule()</a>.</p>

</div>
</div>
<a class="anchor" id="a56c09d1da6107f284d12e079f0de62ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task_timer::save_time_stamp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtime__stamp.html">time_stamp</a> &amp;&#160;</td>
          <td class="paramname"><em>the_stamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor creates an empty timer. </p>
<p>This method grabs the current time stamp from the hardware and overflow counters. In order to prevent the data changing during the time when it's being read (which would cause invalid data to be saved), interrupts are disabled while the time data is being copied. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">the_stamp</td><td>Reference to a time stamp variable which will hold the time </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stl__timer_8cpp_source.html#l00359">359</a> of file <a class="el" href="stl__timer_8cpp_source.html">stl_timer.cpp</a>.</p>

<p>References <a class="el" href="stl__timer_8h_source.html#l00082">time_stamp::data</a>, <a class="el" href="stl__timer_8h_source.html#l00060">time_data_32::half</a>, <a class="el" href="stl__timer_8h_source.html#l00044">TMR_TCNT_REG</a>, and <a class="el" href="stl__timer_8cpp_source.html#l00044">ust_overflows</a>.</p>

</div>
</div>
<a class="anchor" id="ae793fba368c36c813ae581c358c33c48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool task_timer::set_time </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtime__stamp.html">time_stamp</a> &amp;&#160;</td>
          <td class="paramname"><em>t_stamp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current time. </p>
<p>This method sets the current time to the time in the given time stamp</p>
<p>This method sets the timer to a given value. It's not likely that this method will be used, but it is provided for compatibility with other task timer implementations that measure times of day (in hours, minutes, and seconds) and do need to be set by user programs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t_stamp</td><td>A reference to a time stamp containing the time to be set </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="stl__timer_8cpp_source.html#l00395">395</a> of file <a class="el" href="stl__timer_8cpp_source.html">stl_timer.cpp</a>.</p>

<p>References <a class="el" href="stl__timer_8h_source.html#l00082">time_stamp::data</a>, <a class="el" href="stl__timer_8h_source.html#l00060">time_data_32::half</a>, <a class="el" href="stl__timer_8h_source.html#l00044">TMR_TCNT_REG</a>, and <a class="el" href="stl__timer_8cpp_source.html#l00044">ust_overflows</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="stl__timer_8h_source.html">stl_timer.h</a></li>
<li><a class="el" href="stl__timer_8cpp_source.html">stl_timer.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classtask__timer.html">task_timer</a></li>
    <li class="footer">Generated on Fri Sep 20 2013 14:28:00 for Polar Plotter Project by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
